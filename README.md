# Flood detection using Satellite Imagery (Machakos County, 2024) 

<p align="center">
  <img src='data/satellite.png'  width='450'/>
</p>

Hello again 👋  
+ Last year, (2024) Kenya experienced heavy rainfall in the months of March, April and May that resulted in a humanitarian crisis (see photos [here](https://www.reuters.com/pictures/pictures-kenya-floods-force-thousands-flee-2024-04-25/))
+ According to [this UNOCHA report](https://www.unocha.org/publications/report/kenya/kenya-heavy-rains-and-flooding-update-flash-update-7-19-june-2024) based on Kenya's National Disaster Operations Centre, more than 50,000 people in Machakos County were affected by the subsequent floods; of whom 29,000 were displaced from their homes.
+ In this repository, I demonstrate how remote sensing data would have been critical in detecting surface water and mapping the extent of floods over time. Such valuable insight could have aided responders to see the bigger picture quickly, pinpoint critical areas and make data driven decisions. 


## Key terms 📝
Here are a few key concepts to note before proceeding:
1. **Sentinel-2**
+ A pair of European satellites (Sentinel-2A & 2B) that take **multispectral images of Earth** every 5 days at high resolution (10m - 60m)
2. **Multispectral image**
+ An image that has many **bands**, each recording light (or radiation) from a different part of the spectrum - eg. blue, green, red, near-infrared (NIR), shortwave infrared (SWIR), e.t.c
+ Each **band** "sees" the earth differently, and combining them helps detect things such as vegetation, soil, urban areas, or water - such as in this exercise
3. **Image band**
+ One layer of information in a multispectral image
+ Sentinel-2 images, for instance, have `13` bands, eg. `B3` - Green, `B4`- Red, `B8` - NIR, `B11`- SWIR1, e.t.c
4. **Modified Normalized Difference Water Index (MNDWI)**  
+ A remote sensing index that uses the green band and the shortwave infrared (SWIR) band of a satellite's image **to highlight open water** features while suppressing noise from built-up land, soil, and vegetation
+ In the context of Sentinel-2:
>+ `MNDWI = (B3 - B11) / (B3 + B11)`
+ I'll be using `MNDWI` in this exercise
5. **Mask**
+ In the context of working with images in Earth Engine, a mask is an image that tells Earth Engine which pixels to ignore / hide
+ For instance, a _cloud mask_ would hide cloudy pixels, and a _water mask_ would only highlight water pixels
6. **Composite image**
+ An image generated by combining many satellite images. This single image is meant to represent a longer time, or 'best' pixels

## Procedure 🔤
**The general workflow in this exercise is as follows:**  
1. Filter [Sentinel-2](https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2_SR_HARMONIZED) images by year (2024) and location (Machakos county). Sentinel-2 is preferred due to high spatial resolution and a revisit interval of 5 days.
2. For every image retrieved, use the `B3` and `B11` bands to compute a new band, `MNDWI_mask` (with a threshold of -0,05), which is a mask that only highlights water pixels
3. Filter the images by month and composite by `median` to get one cloud-free representative image for distinct months
4. Use the `MNDWI_mask` band from the monthly composite images to calculate the number of water pixels. From the pixel count and Sentinel-2's spatial resolution, calculate the area covered by surface water
5. Plot a time series graph for area covered by surface water, plot and visualize flood maps for different months for comparison
> Comments, working code, and links to the latest official documentation are included every step. You can open the Colab notebook in Google Colab - feel free to explore.

## Note ⚠️
One last thing if you want to execute the code cells in the notebook:
+ For the Earth Engine python API, `ee` to work, you should have registed for an Earth Engine project; which you can do [here](https://earthengine.google.com/signup/)
+ Once registered, you have the option to choose the non-commercial option.
+ Pass the Earth Engine project ID to `ee.Initialize(project=your_ee_project_id)` to initialize your project
+ Also, make sure to use the **same** email for both the Colab notebook and your Earth Engine project

## Tools ⚒️
**The tools used for this exercise are:**
1. [`Google Colab`](https://colab.google/) - A hosted _Jupyter Notebook_ service by Google.
2. [`ee`](https://developers.google.com/earth-engine/apidocs) -  The core API for Earth Engine's geospatial dataset catalog and geospatial computing
3. [`geemap`](https://scikit-learn.org/stable/#) - A package built on top of `ee` that adds interactive mappings and visualization
4. [`rasterio`](https://rasterio.readthedocs.io/en/stable/index.html) - a Python package for working with raster geospatial data
5. [`geopandas`](https://geopandas.org/) - A Python library that extends [`pandas`](https://pandas.pydata.org/docs/index.html) library to make working with vector type geospatial data simple and intuitive
6. [`pandas`](https://pandas.pydata.org/docs/index.html) - An open-source data analysis and manipulation tool built on Python
7. [`matplotlib`](https://matplotlib.org/) - A comprehensive library for making static, animated, and interactive visualizations in Python
8. [`seaborn`](https://seaborn.pydata.org/index.html) - A Python data visualization library based on `matplotlib` that provides a high-level interface for drawing attractive and informative statistical graphics
9. [`requests`](https://requests.readthedocs.io/en/latest/) - An elegant and simple HTTP library for Python

> _Notable module from [The Python Standard Library](https://docs.python.org/3/library/index.html): [`pathlib`](https://docs.python.org/3/library/pathlib.html) for working with file and directory paths_


## Reference 📚
+ Google Earth Engine [developer guide](https://developers.google.com/earth-engine/guides) and [developer docs](https://developers.google.com/earth-engine/apidocs)
+ Introduction to Google Earth Engine in Javascript on [YouTube](https://www.youtube.com/watch?v=K5GTY9sGe5Y&list=PLLW-qoCMKQsx62nKon2-0PMtGzkxlwN7k&pp=0gcJCZYEOCosWNin)
+ [Dorman, M., Graser, A., Nowosad, J., & Lovelace, R. (2025). Geocomputation with Python. CRC Press](https://py.geocompx.org/)
+ Not forgetting [these](https://gist.github.com/rxaviers/7360908) gorgeous gorgeous emojis 😻

> _Santinel-2 Multispectral Image data by [Google Earth Engine](https://developers.google.com/earth-engine/datasets/catalog/COPERNICUS_S2_SR_HARMONIZED)_   
> _Administrative boundaries vector dataset by [GADM](https://gadm.org/download_country.html)_   
> _Illustration by [`Storyset`](https://storyset.com)_ ♥

